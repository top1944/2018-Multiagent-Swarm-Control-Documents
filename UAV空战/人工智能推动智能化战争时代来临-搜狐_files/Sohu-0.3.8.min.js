PassionList=[],PassionReady=function(a){PassionReady.status==1?a.call():PassionList.push(a)},PassionReady.status=0,function(){if(typeof jQuery=="undefined")setTimeout(arguments.callee,100);else{PassionReady.status=1;for(var a in PassionList)PassionList[a].call();PassionList.length=0}}(),PassionReady(function(){(function(a,b,c){var d=a.document,e=a.navigator,f=a.location,g=function(a,c){a=a||{},c=c||0;if(b.isArray(a)){if(a.length>1){c=g.ad_queue.length;for(var d in a)g(a[d],c);g.orderqueue(c),g.queue(c);return!0}a=a[0]}if(!a||!("resource"in a)||!("id"in a)){g.log("Invalid params");return!1}a.type=a.type||"common";if(!(a.type in g.engine)){g.log("Invalid type: "+a.type);return!1}if("order"in a){a.timeout=a.timeout||3e3,g.ad_list[a.id]={bean:a,s:0,group_id:c},c in g.ad_queue||(g.ad_queue[c]=[]),g.ad_queue[c].push({order:a.order,id:a.id});return!0}g.ad_list[a.id]={bean:a,s:0,group_id:-1},g.engine(a);return!0};g.extend=b.extend,b.fn.PositionFixed=function(a){var c={left:0,top:0},d=b.extend(c,a),e=!1,f=b("html");b.browser.msie&&parseInt(b.browser.version)<=6&&(e=!0),e&&f.css("backgroundAttachment")!=="fixed"&&f.css("backgroundAttachment","fixed");return this.each(function(){var a=b(this)[0],c=b(this);e?(c.css("position","absolute"),"right"in d?a.style.setExpression("left","eval((document.documentElement).scrollLeft - "+parseInt(d.right)+' + (document.documentElement).clientWidth-this.offsetWidth-(parseInt(this.currentStyle.marginLeft,10)||0) -(parseInt(this.currentStyle.marginRight,10)||0) ) + "px"'):a.style.setExpression("left","eval((document.documentElement).scrollLeft + "+parseInt(d.left)+') + "px"'),"bottom"in d?a.style.setExpression("top","eval((document.documentElement).scrollTop - "+parseInt(d.bottom)+' + (document.documentElement).clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0) -(parseInt(this.currentStyle.marginBottom,10)||0) ) + "px"'):a.style.setExpression("top","eval((document.documentElement).scrollTop + "+parseInt(d.top)+') + "px"')):(c.css("position","fixed"),"right"in d?c.css("right",parseInt(d.right)):c.css("left",parseInt(d.left)),"bottom"in d?c.css("bottom",parseInt(d.bottom)):c.css("top",parseInt(d.left)))})},b.fn.Upzindex=function(a){return this.each(function(){var a='<iframe     style="position:absolute;z-index:-1;width:e-xpression(this.nextSibling.offsetWidth);height:e-xpression(this.nextSibling.offsetHeight);top:expression(this.nextSibling.offsetTop);left:expression(this.nextSibling.offsetLeft);" frameborder="0">'})},g.extend({debug:!1,position_id_prefix:"beans_",default_timeout:3e3,default_order:10,adserver_url:"http://s.go.sohu.com/new/",max_turn:12,adclick_url:"http://c.go.sohu.com/new/",adimp_url:"http://v.go.sohu.com/",flashplayer:"http://images.sohu.com/bill/s2011/gates/all/images/aplayer-0.3.0.swf?_=20121123.1",ad_list:{},ad_queue:[[]],ad_param:{},ad_default:{},init:function(){typeof d.pv=="undefined"&&(d.pv=[]),b(function(){g.orderqueue(0),g.queue(0)})},cookie:function(a,b,c,d,e,f){this.$document=a,this.$name=b,c&&c>1339111890?this.$expiration=new Date(c*1e3):this.$expiration=c?new Date((new Date).getTime()+c*36e5):null,this.$path=d?d:"/",this.$domain=e?e:null,this.$secure=f},log:function(b){a.console&&(g.debug?a.console.debug&&(a.console.debug(b),a.console.trace()):a.console.log(b))},setDefault:function(a){a.slotid?(a.id=a.slotid,a.itemspaceid=g.getItemSpaceId(a.slotid,0),g.ad_default[a.slotid]=a):g.log("Item Space must be specified!")}}),g.cookie.prototype.store=function(){var a="";for(var b in this){if(b.charAt(0)=="$"||typeof this[b]=="function")continue;a!=""&&(a+="&"),a+=b+":"+escape(this[b])}var c=this.$name+"="+a;this.$expiration&&(c+="; expires="+this.$expiration.toGMTString()),this.$path&&(c+="; path="+this.$path),this.$domain&&(c+="; domain="+this.$domain),this.$secure&&(c+="; secure"),this.$document.cookie=c},g.cookie.prototype.load=function(){var a=this.$document.cookie;if(a=="")return!1;var b=a.indexOf(this.$name+"=");if(b==-1)return!1;b+=this.$name.length+1;var c=a.indexOf(";",b);c==-1&&(c=a.length);var d=a.substring(b,c),e=d.split("&");for(var f=0;f<e.length;f++)e[f]=e[f].split(":");for(var f=0;f<e.length;f++)this[e[f][0]]=unescape(e[f][1]);return!0},g.cookie.prototype.remove=function(){var a;a=this.$name+"=",this.$path&&(a+="; path="+this.$path),this.$domain&&(a+="; domain="+this.$domain),a+="; expires=Fri, 02-Jan-1970 00:00:00 GMT",this.$document.cookie=a},g.cookie.getTurn=function(a,b){var c=g.max_turn,e,f=new g.cookie(d,"TurnSats",24);f.load();var b=b||!1;!b||!g.check(f[b])?(f[a]=e=f[a]==null?parseInt(Math.random()*c+1):parseInt(f[a]),f[a]++,f[a]>c&&(f[a]=1),f.store()):e=f[b];return e},g.cookie.explod=function(a){var b=a.split("&");for(var c=0;c<b.length;c++)b[c]=b[c].split(":");for(var c=0;c<b.lengtendh;c++)this[b[c][0]]=unescape(b[c][1])},g.cookie.getTimesCookie=function(a){a.hour=a.hour||24,a.endtime&&(a.hour=a.endtime);var b=(a.label?a.label:"showtimes")+a.hour*60;a.category=a.category||b;var c=new g.cookie(d,a.category,a.hour,a.path,a.domain);c.load();return c},g.cookie.getShowtimes=function(a){var b=g.cookie.getTimesCookie(a),c=a.key||"showid";return b[c]==null?0:b[c]},g.cookie.setShowtimes=function(a){var b=g.cookie.getTimesCookie(a),c=a.key||"showid";b[c]=b[c]==null?1:parseInt(b[c])+1,b.store();return b[c]},g.cookie.getShowtimesSearch=function(){var a=new RegExp("showtimes\\d+=([^;$]*)","ig"),b=unescape(d.cookie).match(a);if(b){var c=[];for(var e=0;e<b.length;e++){var f=b[e].split("=")[1].split("&");for(var g=0;g<f.length;g++)c.push("x:"+f[g].replace(":",""))}return c.join(",")}return""},g.cookie.support=function(){var a=new Cookie(d,"Tanchuang",24);a.load(),a.visit=a.visit==null?1:1,a.store();var b=new Cookie(d,"Tanchuang",24);b.load();if(b.visit==null)return!1;b.remove();return!0}(),g.extend({flash:function(a){var c={id:"flash"+Math.random(),vars:{},width:300,height:400,src:"",style:"",params:{quality:"high",wmode:"opaque"}},d=b.extend(!0,c,a),e=b.param(d.vars);if(b.browser.msie){var f='<object id="'+d.id+'" width="'+d.width+'" height="'+d.height+'" style="'+d.style+'"';f+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ',f+=' codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=',f+='11,0,0,0"><param name="movie" value="'+d.src+'">';for(var g in d.params)f+='<param name="'+g+'" value="'+d.params[g]+'">';e!=""&&(f+='<param name="flashvars" value="'+e+'">'),f+="</object>"}else{var f='<embed  id="'+d.id+'" name="'+d.id+'" width="'+d.width+'" height="'+d.height+'" style="'+d.style+'"';f+=' src="'+d.src+'" ';for(var g in d.params)f+=" "+g+'="'+d.params[g]+'" ';e!=""&&(f+=' flashvars="'+e+'"'),f+=" type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash' swLiveConnect='true'></embed>"}return f}}),g.extend({engine:function(a){b.isFunction(a.before)&&a.before(a),b.isFunction(g.engine[a.type].initMaterial)&&g.engine[a.type].initMaterial(a),g.ad_list[a.id].s=1;var c=g.engine[a.type](a);if(!c){g.isSkip(a.id),g.log("Ad run error "+a.id);return!1}g.pv.trace({imp:a.impression_id||0,a:1,id:a.adid||0,p:a.itemspaceid||0,f:a.adsrc||0,l:a.latency,k:a.key||a.adid||"",_r:g.random()}),a.md5&&g.pv.md5(a.md5),a.imp&&(a.imp=a.imp.replace("${SLOTID}",g.getSlotId(a.id)),g.pv.imp(a.imp)),b.isFunction(a.after)&&a.after(a),g.debug&&(g.timer.end=(new Date).getTime(),g.log(g.timer));return!0},ad:function(a,c){if(!a||!c){g.log("Need resource and beans_id");return!1}if(!a.click){var d={itemspaceid:c,key:a.key||g.ad_list[c].bean.adid||"",impid:g.ad_list[c].bean.impression_id||"0",adid:g.ad_list[c].bean.adid||"0",rt:1};a.click=g.adclick_url+(g.adclick_url.indexOf("?")>=0?"&":"?")+b.param(d)}a.click=a.click.replace("${SLOTID}",g.getSlotId(c)),a.click=a.click.replace("${TS}",g.random()),"width"in a||(a.width=g.ad_list[c].bean.width||0),"height"in a||(a.height=g.ad_list[c].bean.height||0);if(b.isFunction(g.ad[a.type]))g.ad[a.type](a,c);else{g.log("Invalid ad type: "+a.type);return!1}return!0},button:function(a){switch(a){case"close":return b("<div></div>").css({cursor:"pointer",width:39,height:15}).css("position","absolute").css("z-index",20).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/close.png)").hover(function(){b(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/close_h.png)")},function(){b(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/close.png)")});case"replay":return b("<div></div>").css({cursor:"pointer",width:39,height:15}).css("position","absolute").css("z-index",20).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/replay.png)").hover(function(){b(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/replay_h.png)")},function(){b(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/replay.png)")})}}}),g.extend(g.ad,{inner_html:function(a,c){if(!a.html){g.log("Inner have no html!");return!1}if(!a.wrap){g.log("Iframe have no wrap!");return!1}b("#"+a.wrap).html(a.html);var d=g.clickTrace.Beans(c);g.clickTrace("#"+a.wrap+" a",d,function(a,c){c.c=b(a).attr("href")}),g.isOver(c);return!0},iframe:function(a,c){if(!a.file){g.log("Iframe have no src!");return!1}if(!a.wrap){g.log("Iframe have no wrap!");return!1}a.file=a.file.replace("document.location.href",escape(d.location.href));var e='<iframe id="'+c+'_frame" width="'+a.width+'" height="'+a.height+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" src="'+a.file+'"></iframe>';b(e).bind("load",function(){}).appendTo(b("#"+a.wrap)),g.isOver(c);return!0},flash:function(a,c){if(!a.wrap){g.log("Flash have no wrap!");return!1}var d={vars:{},params:{}};a.allow&&(d.params.allowScriptAccess="always"),a.usePlayer?(d.src=g.flashplayer,b.extend(d.vars,{clickthru:a.click,innersrc:a.file,outerparam:a.imp||""},a.vars)):(d.src=a.file,a.vars=a.vars||{},b.extend(d.vars,{clickthru:a.click},a.vars),a.imp&&(a.imp=a.imp.replace("${SLOTID}",g.getSlotId(c)),g.pv.imp(a.imp))),d.width=a.width||0,d.height=a.height||0,d.style=a.style||"",b.extend(d.params,a.params),b("#"+a.wrap).html(g.flash(d)),g.clickTrace("#"+a.wrap,g.clickTrace.Beans(c)),g.isOver(c);return!0},image:function(a,c){if(!a.wrap){g.log("Flash have no wrap!");return!1}var e=d.createElement("a");e.id=c+"_a",e.href=a.click,e.target="_blank",b("#"+a.wrap).append(e),g.addCoordinate(a.wrap),e.innerHTML='<img src="'+a.file+'" border="0" width="'+a.width+'" height="'+a.height+'"/>',g.clickTrace("#"+a.wrap,g.clickTrace.Beans(c)),g.isOver(c);return!0},text:function(a,c){var e=d.createElement("a");e.id=g.position_id_prefix+a.id,e.href=a.click,e.target="_blank",b("#"+a.wrap).append(e),e.innerHTML=a.text,g.isOver(c);return!0},optaim:function(a,c){if(!a.wrap){g.log("Optaim have no wrap!");return!1}a.tier=a.tier||1,a.visitorder=a.visitorder||1,typeof OptAim!="function"?b.getScript(a.file,function(){clearTimeout(g.ad_list[c].timeout),g.ad_list[c].timeout=setTimeout(function(){g.isSkip(c)},g.ad_list[c].bean.timeout),OptAim.getHtml("sohu",a.wrap,c,a.visitorder,a.width,a.height,a.tier)}):OptAim.getHtml("sohu",a.wrap,c,a.visitorder,a.width,a.height,a.tier),g.clickTrace("#"+a.wrap,g.clickTrace.Beans(c));return!0}}),g.engine.common=function(a){if(b("#"+g.ad_list[a.id].wrap).size()==0){g.log("Common need wrap!");return!1}a.resource.id=a.resource.id||a.id+"_ad",a.resource.wrap=a.resource.wrap||g.ad_list[a.id].wrap,g.ad(a.resource,a.id),a.timeout&&(g.ad_list[a.id].timeout=setTimeout(function(){g.isSkip(a.id)},a.timeout));return!0},g.engine.common.initMaterial=function(a){if(!("wrap"in g.ad_list[a.id])){var b=a.id.split("_");g.ad_list[a.id].wrap=g.position_id_prefix+b[0]}},g.engine.pop=function(a){a.resource.id=a.resource.id||a.id+"_ad",a.resource.wrap=a.resource.wrap||g.ad_list[a.id].wrap,a.resource.usePlayer=!1;if("showtimes"in a.resource&&"times"in a.resource.showtimes&&a.resource.showtimes.times<=g.cookie.getShowtimes(a.resource.showtimes))return!1;g.ad(a.resource,a.id),g.isOver(a.id),"showtimes"in a.resource&&g.cookie.setShowtimes(a.resource.showtimes),g.button("close").bind("click",function(){b("#"+a.resource.wrap).empty().hide()}).css("top",3).css("right",3).appendTo("#"+a.resource.wrap);return!0},g.engine.pop.initMaterial=function(a){b("<div></div>").attr("id","Popadwrap").PositionFixed({right:5,bottom:0}).css("z-index",100).appendTo("body"),g.ad_list[a.id].wrap="Popadwrap"},g.extend({mouseXY:function(a){var b={};b.x=a.layerX||a.offsetX||"-33",b.y=a.layerY||a.offsetY||"-33";return b},md5:function(a){var b=a.match(/^([a-f0-9]{8})([a-f0-9]{2})([a-f0-9]{8})([a-f0-9]{2})([a-f0-9]{6})([a-f0-9]{6})$/);if(b){var c=a.match(/^([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{8})$/),d=["sohu","sohu"],e=parseInt(b[3],16)-parseInt(b[1],16),f=parseInt(b[4],16)-parseInt(b[2],16);if(e>205e5||e<20110101)return!1;if(f<0||f>3)return!1;return{md5:c[1]+","+c[2]+","+c[3]+","+c[4],m:e+"",tag:d[f],id:parseInt(b[6],16)}}return!1},random:function(a){var b=new Date;return a?parseInt(b.getTime()/1e3):b.getTime()},pv:{imp:function(b){b=b.split("|");for(var c=b.length-1;c>=0;c--){var e=new Image;b[c]=b[c].replace("${TS}",g.random()),b[c]=b[c].replace("@local@",a.location.href),e.src=b[c],d.pv.push(e)}},old:function(a,b){var c=g.md5(a);b=b||99,c&&g.pv.imp("http://xls.go.sohu.com/"+ad._md5.m.substring(0,6)+"/"+a+".php?a="+b)},trace:function(a){var c=g.adimp_url+(g.adimp_url.indexOf("?")>=0?"&":"?")+b.param(a);g.pv.imp(c)}}}),g.extend({get:function(a){a=a||{};var c,e=a.timeout||3e3,f=a.url||g.adserver_url,h=a.query||{},i=(new Date).getTime(),j=a.type||"ajax";if(!a.slotid)g.log("Item Space must be specified!");else{if("gettimes"in a&&"times"in a.gettimes){a.gettimes.label="gettimes";if(a.gettimes.times<=g.cookie.getShowtimes(a.gettimes))return!1}if(typeof f=="undefined"){g.log("URL must be specified!");return}a.hold&&!b.isArray(a.slotid)&&!g.checkAdPosition(a.slotid)&&d.write("<div id='"+g.position_id_prefix+a.slotid+"'></div>"),c=g.cookie.getTurn(a.slotid,a.turnsync_id);if(b.isArray(a.slotid))for(var k=a.slotid.length-1;k>=0;k--)g.ad_param[a.slotid[k]]={start:i,options:a};else g.ad_param[a.slotid]={start:i};h.turn=c,h.itemspaceid=g.getItemSpaceId(a.slotid,c,a.unrotate);if(!h.itemspaceid)return;h.ec=h.ec||"utf-8",h.rt=h.rt||0,h.ref=d.referrer||"",h.flash=g.flashVersion,f=f+(f.indexOf("?")>=0?"&":"?")+"showtimes="+g.cookie.getShowtimesSearch();switch(j){case"iframe":if(b.isArray(a.slotid)){g.log("iframe type not allow array slotid");return!1}a.width=a.width||b("#"+g.position_id_prefix+a.slotid).width()||450,a.height=a.height||b("#"+g.position_id_prefix+a.slotid).height()||100,h.respform=1,f=f+"&"+b.param(h),g({id:h.itemspaceid,resource:{height:a.height,width:a.width,file:f,type:"iframe"}});break;case"ajax":default:b.ajax({dataType:"jsonp",timeout:e,scriptCharset:h.ec,error:g.onGetError,success:g.onGetSuccess,itemspaceid:h.itemspaceid,slotid:a.slotid,start:i,url:f,data:h})}"gettimes"in a&&g.cookie.setShowtimes(a.gettimes)}},onGetSuccess:function(a,c){if(b.isArray(a)){var d={};for(var e=0;e<a.length;e++){a[e].latency=g.getLatency(this.start),"ad"in a[e]&&b.extend(a[e],a[e].ad);if("itemspaceid"in a[e]){var f=a[e].itemspaceid.split(" ");a[e].itemspaceid=f[0],a[e].itemspaceid in d?d[a[e].itemspaceid]++:d[a[e].itemspaceid]=0,a[e].id=a[e].itemspaceid+"_"+d[a[e].itemspaceid]}a.length>1&&!("order"in a[e])&&(a[e].order=g.default_order)}}g(a)},onGetError:function(a,c,d){b.isArray(this.slotid)||(this.slotid=[this.slotid]);for(var e=this.slotid.length-1;e>=0;e--)this.slotid in g.ad_default&&g(g.ad_default[this.slotid[e]]);var f=c.toString()||d.toString()||"error0",h={msg:f,latency:g.getLatency(this.start),rt:12,_r:g.random,itemspaceid:this.itemspaceid},i=g.adimp_url+"?"+b.param(h);g.pv.imp(i)},getLatency:function(a){var b=(new Date).getTime(),c=b-a;return c},checkAdPosition:function(a){return b("#"+g.position_id_prefix+a).size()>0?!0:!1},parseItemSpace:function(b){b=b||"";var c=g.getPositionId(b);g.slot=a.document.getElementById(c);var d=a.document.getElementById(c+"_frame");if(!g.checknode(g.slot))g.log("Cannot find slot "+c);else return{id:c,frame:d}},getPositionId:function(a){a=a.split("_");var b=g.position_id_prefix+a[0];return b},getSlotId:function(a){a=a.split("_");var b=+a[0];return b},getItemSpaceId:function(a,c,d){d=b.isArray(d)?d:[],b.isArray(a)||(a=[a]);var e=[];for(var f=a.length-1;f>=0;f--)e.push(a[f]);return e.join(",")}}),g.flashVersion=function(){try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(a){var b=a.GetVariable("$version");return parseInt(b.split(" ")[1].split(",")[0])}return!1}catch(c){if(e.plugins&&e.plugins.length>0){var a=e.plugins["Shockwave Flash"];if(a){hasFlash=1;var d=a.description.split(" ");for(var f=0;f<d.length;++f){if(isNaN(parseInt(d[f])))continue;return parseInt(d[f])}}return!1}return!1}}(),g.queue=function(a){a=a||0;if(a in g.ad_queue){for(var b=0;b<g.ad_queue[a].length;b++)if(g.ad_list[g.ad_queue[a][b].id].s==0){g.engine(g.ad_list[g.ad_queue[a][b].id].bean);return}return}},g.orderqueue=function(a){a=a||0;if(a in g.ad_queue){g.ad_queue[a].sort(function(a,b){if(!("order"in a)||!("order"in b))return 1;return a.order>b.order?1:a.order==b.order?0:-1});return}},g.slotover=function(a){var b=g.ad_list[a].group_id;if(b in g.ad_queue){a=a||"noid";var c=a.split("_");for(var d=0;d<g.ad_queue[b].length;d++){var e=g.ad_queue[b][d].id.split("_");e[0]==c[0]&&a!=g.ad_queue[b][d].id&&(g.ad_list[g.ad_queue[b][d].id].s=2)}return}},g.isOver=function(a){a in g.ad_list&&(g.ad_list[a].s=2,g.ad_list[a].timeout&&clearTimeout(g.ad_list[a].timeout),g.slotover(a),g.queue(g.ad_list[a].group_id))},g.isSkip=function(a){a in g.ad_list&&(g.ad_list[a].s=2,g.ad_list[a].timeout&&clearTimeout(g.ad_list[a].timeout),g.queue(g.ad_list[a].group_id))},g.check=function(a){if(a in g.ad_list)return g.ad_list[a].s!=2?!0:!1;return!1},g.clickTrace=function(a,c,d){b(a).bind("mousedown",function(b){var e=b||e,f=g.mouseXY(e);typeof d=="function"&&d(a,c),g.extend(c,f),g.pv.trace(c)})},g.clickTrace.Beans=function(a){return{imp:g.ad_list[a].bean.impression_id||0,a:2,id:g.ad_list[a].bean.adid||0,p:g.ad_list[a].bean.itemspaceid||0,f:g.ad_list[a].bean.adsrc||0,l:g.ad_list[a].bean.latency,k:g.ad_list[a].bean.key||g.ad_list[a].bean.adid||"",_r:g.random()}},a.Passion=g,g.init()})(window,jQuery,undefined)})