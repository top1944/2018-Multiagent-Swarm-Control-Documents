(function(d){var a="cyqemw6s1";var e={createNickName:"http://changyan.sohu.com/api/2/user/random_nick?callback=?&client_id="+a,login:"http://plus.sohu.com/a/spassport/register/quick?cb=?&_input_encode=UTF-8&nick={nickname}&sign={sign}"};var f=function(k){d.ajax({url:e.createNickName,dataType:"jsonp",type:"get",scriptCharset:"utf-8",success:function(l){k&&k(l)}})};var h=function(l,m,k){d.ajax({url:e.login.replace("{nickname}",encodeURIComponent(l)).replace("{sign}",k),dataType:"jsonp",type:"get",scriptCharset:"utf-8",success:function(o){try{window.SOHUCS.reset()}catch(n){}if(o.code=="0"){m(o)}else{alert("由于系统原因,赠送账号失败，请使用您已有账号登陆")}}})};var b=function(){window.location=window.location};var j=function(k){this.$el=d(k.el);this.$input=d(k.input);this.$submit=d(k.submit);this.callback=k.callback||b};j.prototype.init=function(){var k=this;f(function(l){k.$input.val(l.nickname);k.sign=l.sign});this.$submit.unbind("click").bind("click",function(){h(k.$input.val(),k.callback,k.sign)});return this};j.prototype.destory=function(){this.$input.unbind("click")};var g=['<div class="moodpop" id="freeAccount">','<div class="hd">','<a href="javascript:void(0)" class="close"></a>',"<h4>一切尽在不言中，新闻表情你懂的</h4>  ","</div>",'<div class="bd">','<div class="tip">您可以使用如下账号继续参与本篇新闻的评论哦！</div>','<div class="pub">','<strong class="th">昵称</strong>','<input maxlength="20" type="text" class="txt" id="freeAccountNickname">','<input type="button" class="btn" id="freeAccountBtn">',"</div>","</div>","</div>"].join("");var i=function(k){this.callback=k};var c=null;i.prototype.render=function(){if(d("#freeAccount").size()>0){d("#freeAccount").show()}else{d(g).appendTo("body").show()}c=new j({el:"#freeAccount",input:"#freeAccountNickname",submit:"#freeAccountBtn",callback:this.callback});c.init();var k=this;d("#freeAccount .close").bind("click",function(){k.destory()});d("#freeAccount").css({top:d("#changyanface").position().top+40,left:d("#changyanface").position().left+160})};i.prototype.destory=function(){c.destory();d("#freeAccount").remove()};window.freeAccountUI=i})(jQuery);