(function(j){if(j.CommentLogin){return}function x(J,L,I,N,K,M){document.cookie=J+"="+escape(L)+((I)?"; expires="+I.toGMTString():"")+((N)?"; path="+N:"")+((K)?"; domain="+K:"")+((M)?"; secure":"")}function C(J){var I=document.cookie.indexOf(";",J);if(I==-1){I=document.cookie.length}return unescape(document.cookie.substring(J,I))}function p(L){var J=L+"=";var N=J.length;var I=document.cookie.length;var M=0;while(M<I){var K=M+N;if(document.cookie.substring(M,K)==J){return C(K)}M=document.cookie.indexOf(" ",M)+1;if(M==0){break}}return""}function f(I,K,J){if(p(I)){document.cookie=I+"="+((K)?"; path="+K:"")+((J)?"; domain="+J:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}}var m="regEmail";var q={user:{msg:'请填写你的常用邮箱。<br /> <em id="reg-sohu-email" href="javascript:void(0);">没有电子邮箱？</em>',errMsg:"格式不正确，请修改",isExis:false,regStr:/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,isLegal:false},regEmail:{msg:'4-16位,字母、数字、下划线组成.<em id="reg-use-email" style="" href="javascript:void(0);">常用邮箱注册</em>',errMsg:"邮箱名有问题，请修改",isExis:false,regStr:/[a-zA-z]{1}[a-zA-z0-9_]{3,15}/,isLegal:false},passwd:{msg:"密码应为6-18位，可包含字母、数字、特殊符号",errMsg:"长度不正确，请修改",isExis:false,isLegal:false},passwdAgain:{msg:"再次输入密码",errMsg:"密码不匹配",isExis:false,isLegal:false},nickname:{msg:"请填写2-12位字符，仅支持汉字、字母、数字",errMsg:"请填写2-12位以内的汉字、字母、数字",isExis:false,isLegal:false},vcode:{msg:"请正确输入图片中的中文",errMsg:"验证码错误，请重新输入",isExis:false,isLegal:false},agree:{msg:"",errMsg:"",isExis:false,isLegal:true},username:{msg:"请输入姓名",errMsg:"输入的姓名不正确！",isExis:false,isLegal:false},idcard:{msg:"请输入正确身份证号！",errMsg:"输入的身份证号不正确！",isExis:false,regStr:/^(\d{15}|\d{17}[\dx])$/,isLegal:false},phone:{msg:"请输入正确联系电话，<br />如：010-12345678<br />或：0123-1234567",errMsg:"输入的联系电话不正确！",isExis:false,regStr:/^(\d{3}-\d{8}|\d{4}-\d{7})$/,isLegal:false}};var e="";function H(){j("#regform .reg-action-btn").click(function(){if(v()){y()}else{j("ul#reg input.sohuField").each(function(){if((j.trim(j(this).val()).length==0||j.trim(j(this).val())=="")&&j(this).closest("div").css("display")!="none"){j(this).focus();return false}})}});j("#agree").click(function(){if(j("#agree").attr("checked")=="checked"){q.agree.isLegal=true;j("#agreeTip").hide()}else{q.agree.isLegal=false;j("#agreeTip").show()}});j("ul#reg input.sohuField").each(function(){j(this).unbind("focus");j(this).bind("focus",function(){j(this).parent("div").parent("li").addClass("focus");b(j(this));if(j.trim(j(this).val()).length==0||j.trim(j(this).val())==""||j(this).attr("id")=="vcode"){if(j(this).attr("id")=="user"){w(j(this),"",q[j(this).attr("id")].msg,true);var I=j("#user").parent("div").parent("li").find(".tip")}else{w(j(this),"",q[j(this).attr("id")].msg,true);q[j(this).attr("id")].isLegal=false}}}).bind("blur",function(){j(this).parent("div").parent("li").removeClass("focus");D(j(this))})});j("#passwd").bind("keyup",function(){G(j(this).val())});j(".chkPic img,.chkPic a").bind("click",function(){z();return false});j("#vcode").bind("click focus",function(){if(j("#chkPicDiv").css("display")=="none"){j("#chkPicDiv").show();z()}})}function b(J){if(J.length==0){return}var K=q[J.attr("id")].isExis;var I=q[J.attr("id")].msg;if(K==false){warObj=j("<div class=tip></div>");q[J.attr("id")].isExis=true;warObj.hide();if((J.attr("id")=="vcode")||(J.attr("id")=="user")||(J.attr("id")=="passwd")){warObj.appendTo(J.parent("div").parent("li"))}else{J.parent("div").after(warObj)}}}function D(I){if(j.trim(I.val()).length==0||j.trim(I.val())==""){w(I,"","",false);q[I.attr("id")].isLegal=false;if(I.attr("id")=="user"){o("user")}if(I.attr("id")=="passwd"){d()}}else{u(I)}}function w(L,J,M,I){var K=L.parent("div").parent("li").find(".tip");if(!K.is("div.tip")){q[L.attr("id")].isExis=false;b(L);return}K=L.parent("div").parent("li").find(".tip");K.attr("class","tip "+J);if(typeof(M)=="string"){K.html(J!="ok"?"<span></span>"+M:"")}else{if(typeof(M)=="object"){K.text("");K.append(M)}else{}}if(I==true){K.show()}else{K.hide()}if(J=="error"){L.attr("class","sohuField txtError")}else{L.attr("class","sohuField")}}function u(I){var J=I.attr("id");if(J=="user"){c(I)}else{if(J=="regEmail"){B(I)}else{if(J=="passwd"){t(I)}else{if(J=="passwdAgain"){A(I)}else{if(J=="nickname"){F(I)}else{if(J=="vcode"){s(I)}else{if(J=="agree"){checkAgree(I)}}}}}}}}function c(J){var I=q[J.attr("id")].regStr;J.val(j.trim(J.val()).toLowerCase());if(!I.test(j.trim(J.val()).toLowerCase())){w(J,"error",q[J.attr("id")].errMsg,true);q[J.attr("id")].isLegal=false}else{n(J,false)}}function n(J,I){var K;if(I){K=J.val()+"@sohu.com"}else{K=J.val()}e=K;j.ajax({type:"GET",url:"http://i.sohu.com/a/register/verify?_input_encode=GBK&callback=?",data:{type:"email",value:K},dataType:"jsonp",async:false,beforeSend:function(){w(J,"","查询中，请稍后……",true);q[J.attr("id")].isLegal=false},success:function(L){returnFlag=L.code;if(returnFlag==3){w(J,"error","邮箱格式有问题，请修改",true);o("user");q[J.attr("id")].isLegal=false}else{if(returnFlag==4){w(J,"","该邮件已经注册过，使用该邮件登录，或者更换一个新的邮件",false);i("user");q[J.attr("id")].isLegal=false}else{if(returnFlag==0){w(J,"ok","",true);o("user");q[J.attr("id")].isLegal=true;x("regInfosave",K)}else{w(J,"",q[J.attr("id")].msg,true);o("user");q[J.attr("id")].isLegal=true}}}},error:function(L,N,M){w(J,"error","服务器忙，请稍后重试",true);q[J.attr("id")].isLegal=false}})}function B(J){var I=q[J.attr("id")].regStr;J.val(j.trim(J.val()).toLowerCase());if(!I.test(j.trim(J.val()))){w(J,"error",q[J.attr("id")].errMsg,true);q[J.attr("id")].isLegal=false}else{n(J,true)}}function t(J){if(j.trim(J.val()).length<6||j.trim(J.val()).length>18){w(J,"error",q[J.attr("id")].errMsg,true);q[J.attr("id")].isLegal=false}else{var I=/^(.)\1{5,8}$/;if(I.test(J.val())){w(J,"error","密码不能是相同的数字或字母",true);q[J.attr("id")].isLegal=false}else{var K=["123456","12345678","qwerty","qwaszx","qazwsx","password","abc123"];if(j.inArray(J.val(),K)!=-1){w(J,"error","密码过于简单，请重新输入",true);q[J.attr("id")].isLegal=false}else{w(J,"ok","",true);q[J.attr("id")].isLegal=true}}if(e==J.val()){w(J,"error","密码不能与账户相同",true);q[J.attr("id")].isLegal=false}if(j("#passwdAgain").val()==j("#passwd").val()){w(j("#passwdAgain"),"ok","",true);q.passwdAgain.isLegal=true}}}function A(I){if((I.val()!=j("#passwd").val())||(j.trim(I.val()).length==0)){w(I,"error",q[I.attr("id")].errMsg,true);q[I.attr("id")].isLegal=false}else{w(I,"ok","",true);q[I.attr("id")].isLegal=true}}function l(J){var I=/[\u2E80-\u9FFF\uF92C-\uFFE5]/g;return J.toString().replace(I,"lv").replace(/\r/g,"").length}function F(J){var I=j.trim(J.val());if(j.trim(J.val())<2||j.trim(J.val())>12){w(J,"error",q[J.attr("id")].errMsg,true);q[J.attr("id")].isLegal=false}else{w(J,"","查询中，请稍后……",true);q[J.attr("id")].isLegal=false;j.ajax({url:"http://i.sohu.com/a/register/verify?_input_encode=GBK&type=nick&value="+escape(I)+"&callback=?",dataType:"jsonp",success:function(K){if(K.code==0){w(J,"ok","",true);q[J.attr("id")].isLegal=true;x("nicknamesave",I)}else{if(K.code>0){w(J,"error",K.msg,true);q[J.attr("id")].isLegal=false}}},error:function(){w(J,"error","服务器忙，请稍后重试",true);q[J.attr("id")].isLegal=false}})}}function s(I){if((p("msg")!="none")&&(p("msg")!="")){w(I,"error",q.vcode.errMsg,true);x("msg","none","","/",".i.sohu.com")}else{if(j.trim(I.val())){q.vcode.isLegal=true;w(I,"","",false)}}}function r(I){if((p("password")!="none")&&(p("password")!="")){w(I,"error","密码过于简单，请修改",true);x("password","none","","/",".i.sohu.com")}else{w(I,"","",false)}}function i(J){if(j(".correctMail").length==0){var K=j('<div class="correctMail">');j('<span class=emailTip><span class="icon email"></span>该邮箱已注册，你可以：</span>').appendTo(K);var I=j("<input>").attr({"class":"emailBtn",type:"button",value:"立即登录"}).bind("click",function(){j.CommentLogin.commnetLoginInit(SohuComment.login)});I.appendTo(K);j('<span>或<a id="reg-change-email" href=javascript:void(0);>换一个邮箱</a></span>').appendTo(K);K.appendTo(j("#"+J).parent("div").parent("li"))}else{j(".correctMail").show()}}function v(){if(m=="user"){return q.user.isLegal&&q.passwd.isLegal&&q.passwdAgain.isLegal&&q.nickname.isLegal&&q.vcode.isLegal&&q.agree.isLegal}else{return q.regEmail.isLegal&&q.passwd.isLegal&&q.passwdAgain.isLegal&&q.nickname.isLegal&&q.vcode.isLegal&&q.agree.isLegal}}function h(){window.setTimeout(function(){j("#passwd").val("");j("#passwdAgain").val("")},1000);if(j.trim(j("#vcode").val())){s(j("#vcode"))}if(j.trim(j("#passwd").val())){r(j("#passwd"))}if(p("regInfosave")!=""){var I=p("regInfosave");I=I.substr(0,I.indexOf("@"));j("#regEmail").val(I);B(j("#regEmail"))}if(p("nicknamesave")!=""){j("#nickname").val(p("nicknamesave"));F(j("#nickname"))}}function z(){var I=(new Date()).getTime();var J="http://i.sohu.com/a/register/genvcode?callback=?";j.ajax({url:J,async:false,dataType:"jsonp",success:function(L){var K=L.data[0].vcodeen;j(".chkPic img").attr("src","http://comment4.news.sohu.com/vcode.jpg?vcodeen="+K);j(".chkPic img").show();j("#vcodeHidden").val(K)},error:function(K,M,L){}})}function o(I){if(j(".correctMail")){j(".correctMail").hide()}}function G(I){var J=a(I);j(".psArea").show();if(J==1){j(".psArea div.ptp").removeClass("medium power").addClass("week")}else{if(J==2){j(".psArea div.ptp").removeClass("week power").addClass("medium")}else{if(J==3){j(".psArea div.ptp").removeClass("week medium").addClass("power")}else{j(".psArea div").removeClass("week medium power")}}}}function a(I){var M=(I.search(/[a-zA-Z]/)!=-1)?1:0;var L=(I.search(/[0-9]/)!=-1)?1:0;var K=(I.search(/[_-]/)!=-1)?1:0;var J=M+L+K;if(J==0||J==1){return 1}else{return J}}function d(){j(".psArea").hide();j(".psArea div.ptp").removeClass("medium power")}function E(J){var I=q[J.attr("id")].regStr;J.val(j.trim(J.val()).toLowerCase());if(!I.test(j.trim(J.val()))){w(J,"error",q[J.attr("id")].errMsg,true);q[J.attr("id")].isLegal=false}else{w(J,"ok","",true);q[J.attr("id")].isLegal=true}}function y(){var O=m=="user"?j("#user").val():j("#regEmail").val()+"@sohu.com";var R=j("#passwd").val();var I=j("#nickname").val();var J=j("#username").val();var M=j("#phone").val();var K=j("#idcard").val();var Q=j("#vcode").val();var P=j("#vcodeHidden").val();var S="";var L=window.location.href;var N={email:O,password:R,nick:escape(I),realName:escape(J),phone:"",identityCode:"",activeUrl:"",vcode:Q,vcodeen:P,default_page:L};j.ajax({url:"http://comment4.news.sohu.com/post/space_user_reg",data:N,dataType:"jsonp",jsonpCallback:"postSpaceUserRegResult",success:function(V){var T=V.status;var X=V.extend?V.extend.active:true;var U=V.msg==""||V.msg==undefined?"网络错误！请重试！":V.msg;if(T==1&&X){j.CommentLogin.commentRegOk();setTimeout(function(){j.CommentLogin.commnetLoginInit(SohuComment.login);j("#diglog_wrapper #email").val(O);j("#diglog_wrapper #password").val(R);j("#diglog_wrapper .btn-login").submit()},2000)}else{if(T==3){var W=j("#vcode");w(W,"error",q[W.attr("id")].errMsg,true);z()}else{if(T==1&&!X){j.CommentLogin.commentActive()}else{alert(U)}}}}})}j(document).mousedown(function(J){var I=j(J.target);if(I.is("#reg-change-email")){j(".correctMail").hide();if(j("#user").is(":visible")){j("#user").val("").focus()}else{if(j("#regEmail").is(":visible")){j("#regEmail").val("").focus()}}}else{if(I.is("#reg-sohu-email")){j("#inputEmailWar").hide();j("#regEmailWar").show();j("#regEmailTip").show();o("user");m="regEmail";j("#regEmail").focus()}else{if(I.is("#reg-use-email")){j("#regEmailWar").hide();j("#inputEmailWar").show();j("#regEmailTip").hide();o("user");m="user";j("#user").focus()}}}});var g=function(J,L,O,M){if(typeof(J)!="object"){return}var K=new Function();K.prototype=PassportSC;var P=PassportCardList.length;var N=new K();N.successCalledFunc=O;N.appid=L;N.curCardIndex=P;N.isSetFocus=false;PassportCardList[P]=N;var I=[P,J,M];if(typeof(O)=="function"){O.apply(this,(I||[]))}else{k(P,J)}return};PassportSC.errorTime=0;PassportSC.showMsg=function(L){if(!this.loginMsg){return}var J=this.loginMsg;J.style.display="";j("#err-msg").html("登录名或密码错误 。<br />请检查登录名或密码<br />大小写是否正确！");j("#email").bind("blur",function(){J.style.display="none"});this.errorTime++;if(!j.cookie("ppinf")&&j.cookie("lastdomain")){if(window.SubmitSource){}}var I=j.CommentLogin.useInfo.from;if(this.errorTime>0&&((I&&I==="real")||!I)){var K=j("#diglog_wrapper .user-reg-talk-info");K.html("<em>忘记密码，无法登录？免注册</em><strong><a href='javascript:void(0);'>快速发表&gt;&gt;</a></strong>");K.find("a").click(function(){var M=j("#diglog_wrapper .login-panel .ppcontent .card"),S=j("#diglog_wrapper .login-panel .ppcontent .quick-talk-wrapper"),R=j("#diglog_wrapper .login-panel .pptitle li").eq(0),Q=j("#diglog_wrapper .login-panel .pptitle li").eq(1);Q.show();S.show();S.children(".quick-talk-content").show();S.children(".quick-talk-content").children().show();S.find("#chkPicDiv_talk").show();S.find(".err-msg").hide();S.find(".data-loading").hide();M.hide();R.removeClass("current");Q.addClass("current");var P=new Date().getTime(),O=Math.ceil(Math.random()*10000000);var N=P+O;j("#vcodeHidden_talk").val(N);j(".chkPic-talk img").attr("src","http://comment4.news.sohu.com/vcode.jpg?vcodeen="+N);j(".chkPic-talk img").show();if(typeof j.CommentLogin.useInfo=="undefined"||(!j.CommentLogin.useInfo.from||j.CommentLogin.useInfo.from==="real")){j.regMonitor("quickfail3vcodeopen")}})}};var k=function(K,I){if(K==null){return}var J=PassportCardList[K];J.successCalledFunc(K)};j.CommentLogin={userInfo:{},cardIndex:0,checkPassTimer:null,userData:{},useInfo:{},commentPassCard:function(N,K,S){this.cardIndex=N;var U=PassportCardList[0].emailPostfix[0],P="昵称/邮箱/手机号";if(U===undefined){var L=j.cookie("cusr");if(L&&L.length>0&&L.indexOf("@")>0&&L.indexOf("|")>0){U=L.substring(L.indexOf("|")+1)}}var M=j.CommentLogin.useInfo;j.CommentLogin.Timer=Math.floor(((new Date().getTime())-SohuComment.loadPageTime)/1000)||0;var Q="快速发表",O="输入验证码即可快速发表！",R="确认",J="",I="正在发表，请稍后...";if(M.from=="photo"){var Q="快速保存",O="<strong>无需登录注册</strong>，领用一个新相册，快速保存图片！",R="快速保存",J='什么是领用新相册？<a target="_blank" href="'+M.url+'">立即了解&gt;&gt;</a>',I="正在保存，请稍后..."}else{if(M.from=="blog"){var Q="快速保存",O="<strong>无需登录注册</strong>，领用一个新博客，快速保存文章！",R="快速保存",J='什么是领用新博客？<a target="_blank" href="'+M.url+'">立即了解&gt;&gt;</a>',I="正在保存，请稍后..."}}var T=PassportCardList[N];T.appid="1077";T.usePost=0;T._drawLoginForm=function(){this.cElement.innerHTML=['<div class="login-panel">','<div class="pptitle">',"	<ul>",'		<li class="current"><span class="login-icon icon-login"></span>用户登录</li>','		<li style="display:none"><span class="login-icon icon-qsubmit"></span>'+Q+"</li>","	</ul>","</div>",'<div class="close-wrapper"><a href="javascript:void(0)" title="关闭窗口"><span class="login-icon pannel-close"></span></a></div>','	<div class="passportc get-user">','		<div class="ppcontent" id="ppcontid">','		<form method="post" onsubmit="return PassportCardList['+N+'].doLogin();" name="loginformc">','			<ul class="card">','				<li class="np">','					<label for="email" class="emailTip"></label>','					<input type="text" name="email" id="email" class="ppinput" autocomplete="off" disableautocomplete value="昵称/邮箱/手机号" />','					<div class="error" style="display:none"><span></span><div id="err-msg"></div></div>',"				</li>",'				<li class="np">','					<label for="password" class="passwordTip"></label>','					<input type="password" name="password" id="password" class="ppinput" autocomplete="off" disableautocomplete />',"				</li>",'				<li class="rem">','					<label for="rem"><input type="checkbox" id="rem" name="persistentcookie" value="1" '+PassportSC.defualtRemPwd+"   />下次自动登录</label>",'					<span class="found_pass"><a src="http://passport.sohu.com/web/recover.jsp" href="javascript:void(0);">找回密码</a></span>',"				</li>",'				<li class="login-btn-wrapper">','					<a href="javascript:void(0)"><input type="submit" value="登录" class="login-btn btn-login"  onfocus="this.blur()" /></a>',"				</li>",'			<li class="user-reg-talk-info"><em>想要一个新账号？</em><a href="javascript:void(0);">立即注册&gt;&gt;</a></li>',"			</ul>","		</form>",'		<form method="post" id="talkform" name="talkform">','			<div class="quick-talk-wrapper" style="display:none">','               <div class="quick-talk-content">','					<div class="talk-title">'+O+"</div>",'					<div class="vcode-box">','						<input type="text" name="vcode" id="vcode_talk" class="vcode-input" value="请输入验证码" />','						<input type="hidden" name="vcodeEn" id="vcodeHidden_talk" value=""/>	','						<div class="chkPic-talk" id="chkPicDiv_talk">','							<img width="120" height="33" src="" alt="" style="display:none" />','							<span class="change-vcode"><a href="javascript:void(0)">换一张</a></span>',"						</div>","					</div>",'					<div class="talk-btn-box"><a href="javascript:void(0)"><input class="login-btn btn-talk" type="submit" value="'+R+'" /></a></div>','                   <div class="err-msg">验证码错误!换一个吧！</div>','					<div class="talk-info">'+J+"</div>","               </div>",'               <div class="data-loading">'+I+"</div>","			</div>","		</form>",'			<div class="regWapper">','				<ul class="reg">',"					<li>还没有搜狐账号？</li>",'					<li><a href="javascript:void(0)"><input type="button" class="login-btn btn-reg" value="快速注册" /></a></li>',"				</ul>","			</div>","		</div>","	</div>","</div>"].join("");if(typeof(U)=="string"&&U.indexOf("@")>-1){P=U;j.CommentLogin.commentGetNickname(P)}j("#diglog_wrapper input.btn-reg").click(function(){j.CommentLogin.commentRegInit();if(typeof j.CommentLogin.useInfo=="undefined"||(!j.CommentLogin.useInfo.from||j.CommentLogin.useInfo.from==="real")){j.regMonitor("normalregister")}});j.CommentLogin.commnetDialogClose();var ag=j("#diglog_wrapper");var aj=ag.find(".login-panel .pptitle li").eq(0),al=ag.find(".login-panel .pptitle li").eq(1),W=ag.find(".login-panel .ppcontent .card"),ak=ag.find(".login-panel .ppcontent .quick-talk-wrapper"),ah=ag.find(".quick-talk-wrapper .talk-btn-box .btn-talk"),am=ag.find(".change-vcode a"),ae=ag.find("#vcode_talk"),aa=ag.find(".err-msg"),V=ag.find("#talkform"),an=ag.find(".quick-talk-content"),af=ag.find(".data-loading"),ad=ag.find("#password"),ac=ag.find(".found_pass a"),ai=ag.find(".user-reg-talk-info"),Y=ag.find(".card .np #email");emailInput=ag.find("#email");var ao=j.CommentLogin.useInfo;if((!j.cookie("ppinf")&&!j.cookie("lastdomain")&&(typeof SubmitSource!="undefined")&&ao.hasOwnProperty("from")&&ao.from==="real")&&(!window.kuaisufabiao||window.kuaisufabiao=="undefined")){j.CommentLogin.commentGetVcode(an,ao,S)}else{if(!j.cookie("ppinf")&&j.cookie("lastdomain")&&(typeof SubmitSource!="undefined")){var ab=utf8to16(b64_decodex(j.cookie("lastdomain").split("|")[1]));if(ab.indexOf("|")>-1){var aq=ab.split("|");var X=decodeURIComponent(aq[0]).split("@")[0]}if(/^sohu[a-z0-9]{8}\@sohu\.com/g.test(decodeURIComponent(aq[0]))){var Z="http://comment4.news.sohu.com/direct/pwmod";if(!window.sendOnce){j.ajax({type:"GET",url:Z,dataType:"script",cache:false,scriptCharset:"gbk",data:{passport:X},success:function(ar){if(typeof userpwmod=="undefined"){window.sendOnce=true;j.CommentLogin.commentGetVcode(an,ao,S)}}})}}else{j.CommentLogin.commentGetVcode()}}else{if(J==""&&j("#diglog_wrapper .user-reg-talk-info:visible").length<=0){j(this.cElement).find(".login-panel").height(156)}j.CommentLogin.commentGetVcode()}}ah.click(function(){});am.click(function(){j.CommentLogin.commentGetVcode();return false});ae.focus(function(){if(ae.val()=="请输入验证码"){ae.val("")}aa.hide();aa.text("验证码错误!换一个吧！")});Y.focus(function(){var ar=j(this);if(ar.val()=="昵称/邮箱/手机号"){ar.val("")}});ae.keyup(function(){SohuComment.setUserName()});aj.click(function(){aj.addClass("current");al.removeClass("current");ak.hide();W.show()});al.click(function(){aj.removeClass("current");al.addClass("current");ak.show();W.hide()});V.submit(function(){ae.blur();if(ae.val()==""||ae.val()=="请输入验证码"){aa.text("请输入验证码！");aa.show();return false}an.hide();af.show();j.CommentLogin.commentTalkHandler(S);return false});var ap=function(){if(typeof j.CommentLogin.useInfo=="undefined"||(!j.CommentLogin.useInfo.from||j.CommentLogin.useInfo.from==="real")){j.regMonitor("normalretrievepwd")}ac.attr("href",ac.attr("src")).attr("target","_blank").unbind("click").trigger("click");ac.click(ap)};ac.click(ap);ai.find("a").click(function(){j.CommentLogin.commentRegInit()});emailInput.bind("blur",function(){if(j(this).val()==""){ai.find("em").html("没有账号？")}}).bind("keyup",function(){if(j(this).val()==""){ai.find("em").html("没有账号？")}});if(S==SohuComment.login){al.hide();ak.hide();W.show();aj.addClass("current")}else{if(!!!j.cookie("lastdomain")){aj.removeClass("current");al.addClass("current");al.show();W.hide();ak.show();if(typeof j.CommentLogin.Timer!="undefined"&&j.CommentLogin.Timer<3){j.regMonitor("vcodeshorttime")}}else{if(!!j.cookie("lastdomain")){al.hide();ak.hide();W.show();aj.addClass("current")}}}};T.drawPassportWait=function(V){this.cElement.innerHTML='<div class="dataLoading">正在登录，请稍后...</div>'};T.drawPassportCard=function(){if(j("#diglog_wrapper .quick-talk-success--wrapper").length==0){j("#diglog_wrapper").remove();j.CommentLogin.commentGetUserInfo(S)}};T.drawAInfo=function(V){ele.innerHTML=""};T.drawPassport(K)},doLogout:function(){PassportCardList[this.cardIndex].doLogout()},commentGetVcode:function(M,J,V){var U=(new Date()).getTime();var I=false;if(J&&J.from==="real"){M.hide();j("#diglog_wrapper div").hide();var W="text-align:center;font-size:15px;width:100%;height:280px;_height:auto;line-height:280px;display:inline-block;margin:0;padding:0;";W+=j.browser.msie?(j.browser.version==6?"_padding:140px 0;":""):"";W+="background-color:#EFF4F8;color:#666;font-weight:bold;";var N='<img src="http://comment.news.sohu.com/upload/comment4_1/images/data_loading.gif" />';j("#diglog_wrapper").append('<p style="'+W+'" id="loadStyle">'+N+" 正在发表，请稍等...</p>");j(".comBtn:visible .btn").attr({disabled:"true"});I=true;var O=function(Y){window.startLoadFlash=window.setTimeout(function(){j.regMonitor("vcodeflash");j.regMonitor("quickvcodeopen");var aa=j("#diglog_wrapper .login-panel .ppcontent .card"),ac=j("#diglog_wrapper .login-panel .pptitle li").eq(0),ab=j("#diglog_wrapper .login-panel .pptitle li").eq(1);if(aa.length>0){ab.show();aa.hide();ac.removeClass("current");ab.addClass("current")}M.show();if(j("#diglog_wrapper .ppselecter").length>0){j("#diglog_wrapper .ppselecter").remove()}j(".chkPic-talk img").attr("src","http://comment4.news.sohu.com/vcode.jpg?vcodeen="+Y);j(".chkPic-talk img").show();j("#realuserLoad").remove();j("#diglog_wrapper div").show();j("#vcodeHidden_talk").val(Y);j(".comBtn:visible .btn").removeAttr("disabled");j("#loadStyle").remove();j("#diglog_wrapper .data-loading").hide();j("#diglog_wrapper .regWapper").hide();j("#diglog_wrapper #ppcontid .card .np .error").hide();window.returnEncrypt("",true)},10000);window.completeFlash=function(){window.clearTimeout(startLoadFlash);FlashEncrypt(Y)};window.FlashEncrypt=function(aa){var ab=function(ac){if(navigator.appName.indexOf("Microsoft")!=-1){return window[ac]}else{return document[ac]}};ab("Encrypt").FlashEncrypt(aa)};window.returnEncrypt=function(ab,ac){var aa=window,ad=document.getElementsByTagName("head")[0]||document.documentElement;ad.removeChild(window.script);j("#Encrypt").remove();j("#myContent").remove();var ae=ac||false;if(!ae){var af={vcodeen:Y,sig:ab};j.CommentLogin.commentTalkHandler(V,true,af)}aa.script=aa.completeFlash=aa.FlashEncrypt=aa.returnEncrypt=aa.startLoadFlash=null};j("body").append('<div id="myContent"></div>');var Z={};Z.allowScriptAccess="always";var X={};X.id="Encrypt";X.name="Encrypt";swfobject.embedSWF("http://comment.news.sohu.com/upload/EncryptFlash/commentTrans.swf","myContent","10","10","9.0.0","http://comment.news.sohu.com/upload/EncryptFlash/expressInstall.swf","",Z,X)}}var Q=new Date().getTime(),P=Math.ceil(Math.random()*10000000);var K=Q+P;if(I){var T=document.getElementsByTagName("head")[0]||document.documentElement;var S=document.createElement("script"),L=false;S.setAttribute("type","text/javascript");S.setAttribute("src","http://comment.news.sohu.com/upload/EncryptFlash/swfobject.js");S.async="true";S.onload=S.onreadystatechange=function(){if(!L&&(!S.readyState||S.readyState=="loaded"||S.readyState=="complete")){L=true;O(K);S.onload=S.onreadystatechange=null}};S.error=function(){};T.appendChild(S);window.script=S}else{var R=j("#diglog_wrapper .quick-talk-wrapper");j(".chkPic-talk img").attr("src","http://comment4.news.sohu.com/vcode.jpg?vcodeen="+K);j(".chkPic-talk img").show();j("#vcodeHidden_talk").val(K);R.find(".login-panel").hide();R.find(".data-loading").hide();R.find(".regWapper").hide();if(j("#diglog_wrapper .ppselecter").length>0){j("#diglog_wrapper .ppselecter").remove()}}},commentUpdateNickName:function(N,J,O,M){window.kuaisufabiao=true;var I=this;j("#diglog_wrapper").addClass("quick-nike-wrapper").children().hide();if(j("#diglog_wrapper").children(".close-wrapper").length>0){j("#diglog_wrapper").children(".close-wrapper").show()}else{j("#diglog_wrapper").append('<div class="close-wrapper"><a title="关闭窗口" href="javascript:void(0)"><span class="login-icon pannel-close"></span></a></div>');I.commnetDialogClose()}var K=['             <div class="quick-talk-success--wrapper issue-wrapper">','<div class="issue-content-wrapper">','        <div class="issue-title clear"><span class="issue-tip-2">填写昵称，马上发表！</span><em><a class="haveSohuAccount" href="javascript:void(0)">已有搜狐账号&gt;</a></em></div>','<div class="issue-title-msg">请输入您常用的昵称</div>','<div class="issue-content-form clear">','<div class="issue-form-block clear">',' <div class="issue-form-name">昵称</div>','<div class="issue-form-input">',' <input type="text" class="Ftxt newnickname" value="'+J+'">',' <span class="tips">请输入2-12位中英文字符和数字</span>',"</div>","</div>",'<div class="quick-btn-box"><a href="javascript:void(0)"><input class="updateNickBtn" type="button" value="确认昵称并发表"></a></div>',"</div>",'<div class="issue-content-form-footer"></div>'," </div> ","</div>"].join("");j("#diglog_wrapper").append(K);I.commentNeedChangeUserNameStatic("open");j("#diglog_wrapper .updateNickBtn").click(function(){function P(Q){j("#diglog_wrapper .issue-form-input").addClass("error-msg");j("#diglog_wrapper .newnickname").focus();j("#diglog_wrapper .newnickname").one("keypress",function(){j("#diglog_wrapper .issue-form-input").removeClass("error-msg");j("#diglog_wrapper .tips").html("")});j("#diglog_wrapper .tips").html(Q)}I.commentUpdateNickNameHandler2(N,J,j("#diglog_wrapper .newnickname").val(),O,P)});function L(){j("#diglog_wrapper").remove();I.commnetLoginInit(SohuComment.login);if(j("#diglog_wrapper").find(".close-wrapper").length>1){j("#diglog_wrapper").find(".close-wrapper:eq(0)").remove()}I.commentNeedChangeUserNameStatic("haveNickClick")}j("#diglog_wrapper .haveSohuAccount").click(L)},commentUpdateNickNameHandler2:function(O,J,I,P,L){var K=this;if(I==""||(I.length<2||I.length>12)){L("请填写2-12位以内的中英文字符和数字");return false}if(J==I){j("#diglog_wrapper").addClass("quick-succ-wrapper");SohuComment.upDataUsrInfo({nick:I});K.commentNeedChangeUserNameStatic("confirmSubmit");P();return}var N=jQuery.fn.commMain.Base64Replace(Base64.encode(O));var M="http://comment4.news.sohu.com/direct/cmt_updatenick_"+N+".json";j.ajax({url:M,dataType:"script",cache:false,scriptCharset:"gbk",data:{oldnick:J,newnick:I},success:function(Q){if(updatenick.code==0||updatenick.code==2){j("#diglog_wrapper").addClass("quick-succ-wrapper");SohuComment.upDataUsrInfo({nick:I});K.commentNeedChangeUserNameStatic("confirmSubmit");P()}else{switch(updatenick.code){default:L("您输入的昵称已被占用，请更换昵称后继续")}}}})},commentNeedChangeUserNameStatic:function(I){if(I==="close"||I==="haveNickClick"||I==="confirmSubmit"){if(window.commentNeedChangeUserNameStatic==1){return}else{window.commentNeedChangeUserNameStatic=1}}var J={open:"qregopen",close:"qregclose",haveNickClick:"qregold",confirmSubmit:"qregconfirm"};if(J[I]){j.regMonitor(J[I])}},commentNeedChangeUserName:function(){var I=window.location.host;if(/^news\.sohu\.com$/ig.test(I)){if(j.CommentLogin.useInfo.from=="blog"||j.CommentLogin.useInfo.from=="photo"){return false}return true}else{if(/^pinglun\.sohu\.com$/ig.test(I)){if(!/新闻中心/ig.test(j(".location:eq(0) a:eq(1)").html())){return false}if(typeof j.fn.commMain.defaults.ForceFaceSend!=="undefined"){return false}if(j.CommentLogin.useInfo.from=="blog"||j.CommentLogin.useInfo.from=="photo"){return false}return true}}return false},commentTalkHandler:function(K,W,M){var Z=W||false;var Q=this;var Y=j("#vcode_talk").val();var L=j("#vcodeHidden_talk").val();var V="http://comment4.news.sohu.com/post/quick_reg";var P,U,R,I;var X=j("#diglog_wrapper .quick-talk-content"),O=j("#diglog_wrapper .data-loading"),N=j("#diglog_wrapper #vcode_talk"),J=j("#diglog_wrapper .err-msg"),T=j("#diglog_wrapper .change-vcode a"),S={vcode:Y,vcodeen:L};if(Z){S.vcode="";S.vcodeen=M.vcodeen;S.sig=M.sig}j.ajax({url:V,dataType:"jsonp",data:S,jsonpCallback:"quickRegResult",success:function(ad){j("#diglog_wrapper").show();if(ad.status==1&&ad.extend.password.length==8){if(W){j("#realuserLoad").remove();j(".comBtn:visible .btn").removeAttr("disabled")}U=unescape(ad.extend.nickname);R=unescape(ad.extend.passport);I=ad.extend.password;var ac=PassportCardList.length-1;PassportCardList[ac].drawPassportCard=function(){j.fn.commMain.defaults.urlChange=false;j.CommentLogin.commentGetUserInfo(K);if(!j.picText){Q.commentTalkSuccess(ad)}else{if(K!=j.picText.beforeSavePic){Q.commentTalkSuccess(ad)}else{Q.userData=ad}}};j("#diglog_wrapper #email").val(R);j("#diglog_wrapper #password").val(I);if(Q.commentNeedChangeUserName()){Q.commentUpdateNickName(R,U,function(){j("#diglog_wrapper .btn-login").submit()},{callback:K,flag:W,sigarr:M,data:ad})}else{j("#diglog_wrapper .btn-login").submit()}}else{var ae=j("#SOHUcomment .face-com .erInfo");var ab=j("#vcode");if(ae.length>0){ae.html("验证码输入错误,请重新输入")}switch(ad.status){case 2:j.regMonitor("vcodeinvalid");break;case 99:j.regMonitor("vcoderegfail");break}j.regMonitor("quickvcodeopen");ab.val("");ab.focus();J.show();j("#diglog_wrapper .login-panel").hide();T.trigger("click");O.hide();X.show();j("#realuserLoad").remove();j("#diglog_wrapper div").show();j(".comBtn:visible .btn").removeAttr("disabled");j("#loadStyle").remove();j("#diglog_wrapper .data-loading").hide();j("#diglog_wrapper .regWapper").hide();if(j("#diglog_wrapper #ppcontid .error").length>0){j("#diglog_wrapper #ppcontid .error").hide()}if(j("#diglog_wrapper .ppselecter").length>0){j("#diglog_wrapper .ppselecter").remove()}(function aa(){var af=j("#diglog_wrapper").children("div:visible");if(af.length>0&&af.eq(0).innerHTML==""||af.eq(0).innerHTML===undefined){j(af.eq(0)).hide()}})();return false}},error:function(){j.regMonitor("vcodeerror");j.regMonitor("quickvcodeopen")}})},commnetDialogPosition:function(){var I=j("#diglog_wrapper");var P=j(window),O=j(document);var J="465";var L=I.height();var K=O.scrollTop();var N=parseInt(P.height()-L)/2+K;var M=parseInt(P.width()-J)/2;I.css({top:N+"px",left:M+"px"})},commnetDialog:function(){var J=j(document.body);var I='<div id="diglog_wrapper" class="diglog-wrapper user-reg"></div>';if(j("#diglog_wrapper").length==0){j(I).appendTo(J)}},commnetDialogClose:function(){var K=this;var J=j("#diglog_wrapper");var L=j("#diglog_wrapper span.pannel-close");var I=j("#diglog_wrapper .login-panel .ppcontent .card");L.click(function(){if(window.kuaisufabiao){K.commentNeedChangeUserNameStatic("close");window.commentNeedChangeUserNameStatic=undefined;window.kuaisufabiao=undefined;SubmitSource=undefined}if(J.length!=0){if(typeof SubmitSource!=="undefined"&&(I.length>0&&I.css("display")==="block")){j.regMonitor("quickloginclose");SubmitSource=false}if(J.find(".quick-talk-success--wrapper").length>0){if(typeof j.CommentLogin.useInfo=="undefined"||(!j.CommentLogin.useInfo.from||j.CommentLogin.useInfo.from==="real")){j.regMonitor("quicksuccessclose")}}if(j(this).parents(".issue-wrapper").length==0){J.remove()}}return false})},commentGetUserInfo:function(L){var K=PassportSC.cookieHandle();K=j.fn.commMain.Base64Replace(Base64.encode(K));var J={};var I="http://hs.i.sohu.com/account/accountinfo/?xpts="+K+"&from=comment&cb=?";j.ajax({type:"get",url:I,dataType:"jsonp",success:function(M){j.extend(SohuComment.userInfo||{},M.data[K]||{},{base64:K,userId:PassportSC.cookieHandle()});if(typeof L=="function"){L()}}})},commentGetNickname:function(K){K=j.fn.commMain.Base64Replace(Base64.encode(K));var J="";var I="http://hs.i.sohu.com/account/accountinfo/?xpts="+K+"&from=comment&cb=?";j.ajax({type:"get",url:I,dataType:"jsonp",success:function(L){if(L.data&&L.data[K]&&L.data[K].nick){J=L.data[K].nick;j("#diglog_wrapper .passportc .card .np #email").val(J)}}})},commentTalkSuccess:function(ah,ag){if(!this.TalkSuccessDisplayed){this.TalkSuccessDisplayed=1}else{if(window.kuaisufabiao===true){return}}if(ag&&ag.error){if(j("#diglog_wrapper").length>0){j("#diglog_wrapper").remove()}return}var Y=this;var W,ac,Z,J,X;ac=unescape(ah.extend.nickname);Z=unescape(ah.extend.passport);J=ah.extend.password;X=ah.extend.seq,thisUrl=window.location,expdate=new Date(),cdate="",link="http://q.sohu.com/q/23274/t/55473842",linkText="活动说明&gt;&gt;",titleText="发表成功！您已获得搜狐通行证账号，请修改账号信息：",secondTitle="",btnName="确认",titleClass="",appid="";if(ag){link=ag.link;j.CommentLogin.useInfo.closeUrl=ag.link;titleClass="long_title";appid=1019;btnName="确认";if(ag.from=="photo"){linkText="进入相册查看&gt;&gt";titleText="图片已成功保存到您的相册！";secondTitle="(为新账号设置密码，立刻拥有个人专属相册)"}else{if(ag.from=="blog"){linkText="进入博客查看&gt;&gt;";titleText="文章已成功保存到您的博客！";secondTitle="(为新账号设置密码，立刻拥有个人专属博客)"}}}var aj=['<div class="quick-talk-success--wrapper issue-wrapper">','<div class="close-wrapper"><a title="关闭窗口" href="javascript:void(0)"><span class="login-icon pannel-close"></span></a></div>','<div class="issue-content-wrapper">','	<div class="issue-title clear"><span class="issue-tip-2 '+titleClass+'">'+titleText+"</span></div>",'<div class="issue-title-msg">'+secondTitle+"</div>",'	<div class="issue-content-form clear">','		<div class="issue-form-block clear user-nick">','			<div class="issue-form-name">用户昵称：</div>','			<div class="issue-form-input"><span><em>'+ac+'</em> &nbsp;<a href="javascript:void(0);">[修改]</a></span></div>',"		</div>",'		<div class="issue-form-block clear change-nick">','		<form id="nnameform" name="nnameform" method="post">','			<div class="issue-form-name">用户昵称：</div>','			<div class="issue-form-input pnickname"><input type="text" class="Ftxt set-nname-input" value="'+ac+'"><input id="old_nickName" type="hidden" value="'+ac+'" name="old_nickName">','				<div class="error-window"><span></span><em>昵称已被占用，换一个</em></div>',"			</div>",'			<div class="issue-form-auto"><input type="submit" class="login-btn btn-set-nname" value="确认修改"><span><a href="javascript:void(0);">[取消]</a></span></div>',"			</form>","		</div>",'		<iframe name="password_frame" id="pswframe" width="375" scrolling="no" height="135" frameborder="0" marginwidth="0" marginheight="0" allowtransparency="true" src="http://passport.sohu.com/web/UpdatePwdAccessAction.action?md5=false&opshow=false&op='+J+"&btnName="+btnName+"&appid="+appid+'"></iframe>',"	</div>",'	<div class="issue-content-form-footer"></div>',"</div>","</div>",'	<div class="quick-talk-success--wrapper user-set-wrapper">','	<div class="user-set-content-wrapper">','		<div class="user-set-title">您尚未完成账号密码设置，下次可用如下账号登录，请牢记！</div>','		<div class="user-set-content-form">','			<div class="user-set-form clear">','				<div class="form-left iconA"></div>','				<div class="form-center">用户昵称：</div>','				<div class="form-right"><span class="nick-name"></span></div>',"			</div>",'			<div class="user-set-form clear">','				<div class="form-left iconB"></div>','				<div class="form-center">密码：</div>','				<div class="form-right">'+J+"</div>","			</div>",'			<div class="user-set-btn clear"><div><a href="javascript:void(0);"><input type="button" class="" value="返回修改账号信息"></a></div><em><a href="http://comment4.news.sohu.com/download.jsp?seq='+X+'">[关闭并保存账号]</a></em><a class="savepass" target="_blank" style="display:none;" href="http://comment4.news.sohu.com/download.jsp?seq='+X+'"><em></em></a></div>',"		</div>",'		<div class="issue-content-form-footer"></div>',"	</div> ","</div>"].join("");if(Y.commentNeedChangeUserName()){titleText="已发表成功！",btnName="确认";secondTitle="请设置您的常用密码";aj=['<div class="quick-talk-success--wrapper issue-wrapper">','<div class="close-wrapper"><a title="关闭窗口" href="javascript:void(0)"><span class="login-icon pannel-close"></span></a></div>','<div class="issue-content-wrapper">','   <div class="issue-title clear"><span class="issue-tip-2 '+titleClass+'">'+titleText+"</span></div>",'<div class="issue-title-msg">'+secondTitle+"</div>",'   <div class="issue-content-form clear">','       <iframe name="password_frame" id="pswframe" width="351" scrolling="no" height="135" frameborder="0" marginwidth="0" marginheight="0" allowtransparency="true" src="http://passport.sohu.com/web/UpdatePwdAccessAction.action?md5=false&opshow=false&op='+J+"&btnName="+btnName+"&appid="+appid+'"></iframe>',"   </div>",'   <div class="issue-content-form-footer"></div>',"</div>","</div>","</div>"].join("")}j("#diglog_wrapper").html(aj);j.CommentLogin.checkPassTimer=window.setInterval(Y.commentSetPassStatus,5000);var ai="http://pinglun.sohu.com/s"+j.fn.commMain.defaults.topicId+".html",P=j("#diglog_wrapper"),M=P.find(".issue-wrapper"),aa=P.find(".user-set-wrapper"),K=P.find(".user-set-btn input"),V=P.find(".user-set-form span.nick-name"),af=P.find(".user-set-btn em a");j("#diglog_wrapper .view-pinglun a").click(function(){if(location.href!=ai){location.href=ai}else{j("#diglog_wrapper span.pannel-close").click()}});j("#diglog_wrapper span.pannel-close").click(function(){window.clearInterval(j.CommentLogin.checkPassTimer);P.remove()});K.click(function(){M.show();aa.hide();j.CommentLogin.checkPassTimer=window.setInterval(Y.commentSetPassStatus,5000)});af.click(function(){if(typeof j.CommentLogin.useInfo=="undefined"||(!j.CommentLogin.useInfo.from||j.CommentLogin.useInfo.from==="real")){j.regMonitor("quickdownload")}var ak=j(this).attr("src");setTimeout(function(){j("#diglog_wrapper").remove();var al="http://pinglun.sohu.com/s"+j.fn.commMain.defaults.topicId+".html";if(location.href!=al){location.href=al}},200);return});var T=j("#diglog_wrapper .ppass .set-pass a"),R=j("#diglog_wrapper .ppass .set-pass .login-btn"),U=j("#diglog_wrapper .ppass .puserport span"),ab=j("#diglog_wrapper .puser-save a"),S=j("#diglog_wrapper .issue-form-input a"),Q=j("#diglog_wrapper .user-nick"),L=j("#diglog_wrapper .change-nick"),ad=j("#diglog_wrapper .issue-form-auto a");var ae=j("#diglog_wrapper .pnick .set-nick a"),O=j("#diglog_wrapper .pnickname .set-nname-input"),I=j("#diglog_wrapper #nnameform"),N=j("#diglog_wrapper .error-window");nickErrTxt=j("#diglog_wrapper .error-window em");S.click(function(){var ak=Q.find(".issue-form-input em").html();L.find(".set-nname-input").val(ak);Q.hide();L.show()});ad.click(function(){Q.show();L.hide();O.parent("div").removeClass("error-msg");N.hide()});O.focus(function(){O.parent("div").removeClass("error-msg");N.hide()});I.submit(function(){nickName=j.trim(O.val());if(nickName==""||(nickName.length<2||nickName.length>12)){O.parent("div").addClass("error-msg");nickErrTxt.text("请填写2-12位以内的中英文字符和数字");N.show();return false}Y.commentSetNickNameHandler();return false});T.click(function(){R.attr("disabled","disabled").removeClass("btn-set-pass").addClass("btn-set-no")});if(j.cookie("cusr")==null){expdate.setTime(expdate.getTime()+1000*60*60*24*365);cdate=Date.parse(expdate);j.cookie("cusr",cdate+"|"+Z,{expires:expdate,path:"/",domain:"sohu.com",secure:false})}ab.click(function(){if(typeof j.CommentLogin.useInfo=="undefined"||(!j.CommentLogin.useInfo.from||j.CommentLogin.useInfo.from==="real")){j.regMonitor("quickdownload")}setTimeout(function(){window.open(ab.attr("src"))},200)});if(typeof j.CommentLogin.useInfo=="undefined"||(!j.CommentLogin.useInfo.from||j.CommentLogin.useInfo.from==="real")){j.regMonitor("quickvcodesuccess")}Y.commnetDialogClose();return false},showCommTalkSuccess:function(I){if(!this.userData.extend){return"normallogin"}this.commentTalkSuccess(this.userData,I)},commentSetNickNameHandler:function(){var M=SohuComment.userInfo.base64,O=j("#diglog_wrapper .pnickname #old_nickName").val(),K=j("#diglog_wrapper .pnickname .set-nname-input").val(),L=j("#diglog_wrapper .pnickname .set-nname-input"),R=j("#diglog_wrapper .pnickname"),P=j("#diglog_wrapper #nnameform"),S=j("#diglog_wrapper .error-window"),U=j("#diglog_wrapper .error-window em"),N=j("#diglog_wrapper .pnick .set-nick .btn-set-nname"),Q=j("#diglog_wrapper .user-nick"),I=j("#diglog_wrapper .change-nick"),J=I.find("#old_nickName");var T="http://comment4.news.sohu.com/direct/cmt_updatenick_"+M+".json";j.ajax({url:T,dataType:"script",cache:false,scriptCharset:"gbk",data:{oldnick:O,newnick:K},success:function(V){if(updatenick.code==0||updatenick.code==2){Q.find("span em").html(K);J.val(K);Q.show();I.hide();I.find(".Ftxt").attr("value",K);SohuComment.upDataUsrInfo({nick:K})}else{var W=function(X){L.parent("div").addClass("error-msg");U.text(X);S.show()};switch(updatenick.code){default:W("昵称已被使用")}}}})},commentSetPassStatus:function(){var I=this;var J=j("#diglog_wrapper .ppass .set-pass .login-btn"),N=j("#diglog_wrapper .ppass .puserport span"),L=j("#diglog_wrapper .puserport"),M=SohuComment.userInfo.userId,M=M.substr(0,M.indexOf("@"));var K="http://comment4.news.sohu.com/direct/pwmod";j.ajax({type:"GET",url:K,dataType:"script",cache:false,scriptCharset:"gbk",data:{passport:M},success:function(O){if(typeof userpwmod=="object"){j.CommentLogin.testGift();window.clearInterval(j.CommentLogin.checkPassTimer);j.CommentLogin.checkPassTimer=null;j("#SOHUcomment .remark .reLink .setPass").remove();j("#SOHUcomment .remark .reLink .time-prompt-box").remove()}}})},commentDrawReg:function(){var I=this;var J=['<div class="regAreaWar">','<div class="close-wrapper"><a href="javascript:void(0)" title="关闭窗口"><span class="login-icon pannel-close"></span></a></div>','<div class="topT" id="usedEmailTip"><span>&nbsp;</span>已经有"搜狐通行证"？您可以<a href="javascript:void(0)">直接登录</a>,无需注册</div>','<form id="regform" name="regform" method="post" action="" autocomplete="off" disableautocomplete>','<input name="bru" type="hidden" value="http://i.sohu.com" />','<input name="from" type="hidden" value="" />','<input name="sappId" type="hidden" value="" />','<ul id="reg" class="reg clear">','	<li class="regEmailArea">','		<div class="inputArea" id="inputEmailWar" style="display:none">','			<label for="user">常用邮箱</label><input type="text" name="user" id="user" class="sohuField" />',"		</div>",'		<div class="inputArea" id="regEmailWar">','			<label for="regEmail">邮箱名</label><input type="text" name="regEmail" id="regEmail" class="sohuField" />','			<span class="sohuSuffix">@sohu.com</span>',"		</div>","	</li>",'	<li class="regPassArea">','		<div class="inputArea">','			<label for="passwd">创建密码</label><input type="password" name="passwd" id="passwd" class="sohuField" />',"		</div>",'		<div class="psArea">','    		<span></span>密码强度：<div class="ptp week"></div><em class="ptt"></em>',"    	</div>","	</li>","	<li>",'		<div class="inputArea">','			<label for="passwdAgain">确认密码</label><input type="password" name="" id="passwdAgain" class="sohuField" />',"		</div>","	</li>","	<li>",'		<div class="inputArea">','			<label for="nickname">昵称</label><input type="text" name="nickname" id="nickname"class="sohuField" />',"		</div>","	</li>","	<li>",'		<div class="inputArea chkcode">','			<label for="vcode">验证码</label><input type="text" name="vcode" id="vcode"class="sohuField" />','			<input type="hidden" id="vcodeHidden" name="vcodeEn" value=""/>','			<div class="chkPic" id="chkPicDiv">','				<img width="120" height="33" src="" alt="" />','				<span><a href="javascript:void(0)">换一张</a></span>',"			</div>","		</div>","	</li>",'	<li class="agree">','		<div class="checkAreaWar">','			<label for="agree">','				<input type="checkbox" name="" id="agree" checked="checked" />同意 <a href="http://passport.sohu.com/web/serviceitem.jsp" target="_blank">注册协议</a>',"			</label>","		</div>",'		<div class="tip error" id="agreeTip"><span></span>需要先同意《搜狐网络服务使用协议》才能继续注册！</div>',"	</li>",'	<li class="reg-action-wrapper">','		<a href="javascript:void(0)"><input type="button" value="注册" class="reg-action-btn" /></a>',"	</li>","</ul>","</form>","</div>"].join("");j("#diglog_wrapper").html(J);j("#usedEmailTip a").click(function(){I.commnetLoginInit(SohuComment.login)});var K=['<li class="line-wrapper"><div class="line"></div></li>',"<li>",'	<div class="inputArea">','		<label for="username">真实姓名</label><input type="text" name="username" id="username" class="sohuField" value="测试" />',"	</div>","</li>","<li>",'	<div class="inputArea">','		<label for="idcard">身份证号</label><input type="text" name="idcard" id="idcard" class="sohuField" value="111111111111111" />',"	</div>","</li>","<li>",'	<div class="inputArea">','		<label for="phone">联系电话</label><input type="text" name="phone" id="phone" class="sohuField" value="010-12345678" />',"	</div>","</li>"].join("")},commentRegOk:function(){var I=['<div class="regAreaWar">','<a href="javascript:void(0)" title="关闭窗口"><span class="close"></span></a>','	<div class="regOk" id="">','		<div class="icon"></div>','		<div class="txt">',"			<strong>欢迎，您已成功注册搜狐空间</strong>","			页面即将跳转，请您登录！","		</div>","	</div>","</div>"].join("");j("#diglog_wrapper").html(I)},commentActive:function(){var I=this;var J=m=="user"?j("#user").val():j("#regEmail").val()+"@sohu.com";var L="www."+J.substr(J.indexOf("@")+1);var K=['<div class="regAreaWar">','	<a href="javascript:void(0)" title="关闭窗口"><span class="close"></span></a>','	<div class="topT" id="">','		<div class="actTip">','		<div class="emt"><span></span>点击邮件激活链接，完成注册</div>','		确认邮件已发送至邮箱<a href="http://'+L+'" target="_blank">'+J+"</a><br />","		点击邮件中的激活链接,开始畅游搜狐吧!<br />",'		<input type="button" value="查看邮箱" class="viewEmail" onclick="window.open(\'http://'+L+"')\" />","		</div>","	</div>",'	<div class="actHelp">',"		<ul>",'			<li class="b">还未收到确认邮件?</li>',"			<li>请尝试以下任意一种方式</li>","			<li>1.在邮件的广告文件夹、垃圾文件夹中找找看;</li>",'			<li>2.用注册邮箱向<a href="javascript:void(0)">blogreg@sohu.com</a>发送一封标题为“我要激活” 的邮件;</li>','			<li>3.<a id="reSendEmail" href="javascript:void(0);">点此重新发送确认信</a> ;</li>','			<li>4.如果您发现注册邮箱写错了, <a id="reRegBtn" href="javascript:void(0)">请重新注册</a>;</li>',"		</ul>","	</div>","</div>"].join("");j("#diglog_wrapper").html(K);I.commnetDialogClose();j("#diglog_wrapper #reSendEmail").bind("click",function(){var N="http://i.sohu.com/login/remail.do?passport="+J;try{j.ajax({type:"get",dataType:"jsonp",url:N,success:function(O){}});alert("已经成功地向 "+J+" 发送了确认信，请您查收。")}catch(M){}});j("#diglog_wrapper #reRegBtn").click(function(){I.commentRegInit()})},commentRegInit:function(){if(m=="user"){m="regEmail"}this.commnetDialog();this.commentDrawReg();this.commnetDialogPosition();this.commnetDialogClose();H();h();z();if(j.browser.msie&&(j.browser.version=="6.0")){setTimeout(function(){j("#chkPicDiv a").trigger("click")},300)}},commnetLoginInit:function(K,J){if(j.cookie("ppinf")){}else{if(J){j.CommentLogin.useInfo=J}else{if(typeof j.fn.commMain.defaults.ForceFaceSend!=="undefined"){j.CommentLogin.useInfo={from:"real"}}else{var L=Math.floor(((new Date().getTime())-SohuComment.loadPageTime)/1000)||0;if(L>=3){j.CommentLogin.useInfo={from:j.CommentLogin.useInfo.from=="blog"?"blog":"real"}}else{j.CommentLogin.useInfo={}}}}var I=function(M){M.commnetDialog();M.commnetDialogPosition();g(document.getElementById("diglog_wrapper"),1077,j.CommentLogin.commentPassCard,K);j("#password:visible").focus()};I(this);if(window.SubmitSource===true){j.regMonitor("quickshowlogin")}}},testGift:function(){j.ajax({type:"GET",dataType:"jsonp",url:"http://comment4.news.sohu.com/direct/gift?callback=?",success:function(M){if(!M.name||M.name===""){return}var N=M.name;var J=M.number;var P=j("#diglog_wrapper");var K="关闭";var L="评论审核通过后，您将获得<span>10金币</span>新人奖励";var Q='恭喜！您将获得<span>精美小狐狸公仔</span>一个！</br>请牢记您的领取凭证码：<em class="gift_code"></em>';var S="javascript:void(0);";var T=j.CommentLogin.useInfo;var R="";var I="";if(N=="ifox"){K="&nbsp;&nbsp;领取小狐狸公仔"}if(T.from&&T.from!=="real"){if(T.from=="photo"){K="现在就去您的相册看看吧";S=T.closeUrl;R="target='_blank'";L="全新相册功能等待您去体验！";Q="全新相册功能等待您去体验！"}else{if(T.from=="blog"){K="现在就去您的博客看看吧";S=T.closeUrl;R="target='_blank'";L="全新博客功能等待您去体验！";Q="全新博客功能等待您去体验！"}}I="background:none;padding-left:0;"}var O=['<div class="quick-talk-success--wrapper present-fox-wrapper">','	<div class="close-wrapper"><a title="关闭窗口" href="javascript:void(0)"><span class="login-icon pannel-close"></span></a></div>','	<div class="issue-content-wrapper ifox">','		<div class="issue-title clear"><span class="issue-tip-1" style="'+I+'" ><em>账号信息修改成功!</em></span></div>',"<p>"+Q+"</p>",'		<div class="issue-form-button"><a target="_blank" href="http://q.sohu.com/q/23274/t/55473842"><span>'+K+"</span></a></div>","	</div> ",'	<div class="issue-content-wrapper gold">','		<div class="issue-title clear"><span class="issue-tip-1 issue-tip-4" style="'+I+'"><em>账号信息修改成功!</em></span></div>',"<p>"+L+"</p>",'		<div class="issue-form-button btn-close"><a href="'+S+'" '+R+"><em>"+K+"</em></a></div>","	</div>","</div>"].join("");P.html(O);if(N==="gold"||(T.from&&T.from!=="real")){P.find(".ifox").hide();if(!T.from||T.from==="real"){P.find(".gold a").click(function(){P.remove();var U="http://pinglun.sohu.com/s"+j.fn.commMain.defaults.topicId+".html";if(location.href!=U){location.href=U}});P.css("width","350px");P.find(".quick-talk-success--wrapper").css("width","348px");P.find(".btn-close input").css("width","106px")}else{}}else{P.find(".gold").hide();P.find(".ifox .gift_code").html(M.pcode);P.css("width","350px");P.find(".quick-talk-success--wrapper").css("width","348px")}P.find(".close-wrapper").click(function(){P.remove()})}})}}})(jQuery);